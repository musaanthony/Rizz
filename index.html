<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ðŸ”¥ Rizz System â€” Version 1 (Phase A)</title>
<style>
/* =========================
   Rizz System â€” Single-file
   Version 1 (Phase A) â€” merged, polished
   ========================= */

:root{
  --bg:#ffffff;
  --card:#f8fafc;
  --muted:#6b7280;
  --accent:#00bfa6;
  --accent-2:#06a88f;
  --danger:#ff6b6b;
  --text:#0f1724;
  --border:#e6eef2;
}

/* Reset + base */
*{box-sizing:border-box}
html,body{height:100%;margin:0;background:var(--bg);color:var(--text);font-family:-apple-system,Segoe UI,Roboto,Helvetica,Arial;-webkit-font-smoothing:antialiased}
.wrap{max-width:820px;margin:18px auto;padding:14px}

/* Header */
.header h1{font-size:26px;margin:0 0 6px;letter-spacing:-0.3px}
.header .muted{font-weight:500;color:var(--muted);font-size:15px}
.sub{margin:6px 0 12px;color:var(--muted);font-size:14px}

/* Controls */
.controls-row{display:flex;gap:10px;align-items:center;flex-wrap:wrap;margin-bottom:8px}
.input{flex:1;padding:12px;border-radius:12px;border:1px solid var(--border);font-size:15px;background:linear-gradient(180deg,#fff,#fcfdff)}
.btn-group{display:flex;gap:8px}
.btn{padding:10px 14px;border-radius:12px;border:1px solid rgba(15,23,36,0.06);background:white;cursor:pointer;font-weight:600}
.btn.primary{background:linear-gradient(180deg,var(--accent),var(--accent-2));color:#fff;border:none}
.btn.ghost{background:transparent;border:1px solid var(--border);color:var(--text)}
.pill{padding:8px 12px;border-radius:999px;border:1px solid var(--border);background:#fff;cursor:pointer}
.pill.danger{background:var(--danger);color:#fff;border:none}

/* Card */
.card{background:var(--card);padding:12px;border-radius:12px;margin-bottom:12px;box-shadow:0 8px 26px rgba(2,6,23,0.04)}
.card-top{display:flex;flex-direction:column;gap:10px}
.phase-title{font-weight:700;font-size:16px}
.bar-wrap{height:12px;background:#eef6f4;border-radius:999px;overflow:hidden}
.bar-inner{height:100%;width:0%;background:linear-gradient(90deg,var(--accent),var(--accent-2));transition:width 320ms linear}

/* card actions */
.card-actions{display:flex;gap:10px;margin-top:10px;flex-wrap:wrap}

/* list */
.list{display:flex;flex-direction:column;gap:10px;min-height:40px;margin-top:8px;padding-bottom:12px}

/* person row */
.person{display:flex;align-items:center;gap:12px;background:#fff;border-radius:12px;padding:10px;border:1px solid var(--border);box-shadow:0 6px 18px rgba(2,6,23,0.03)}
.person.paused{opacity:0.48;filter:grayscale(0.02)}
.name{min-width:90px;font-weight:700}
.score{font-weight:700}
.small-bar{width:120px;height:8px;background:#eef6f8;border-radius:999px;overflow:hidden}
.small-inner{height:100%;width:0%;background:linear-gradient(90deg,var(--accent),var(--accent-2));transition:width 260ms ease}
.right{margin-left:auto;display:flex;gap:8px;flex-wrap:wrap}
.small{padding:8px 10px;border-radius:10px;border:1px solid var(--border);background:#fff;cursor:pointer}
.small.ghost{background:transparent}
.small.danger{background:var(--danger);color:#fff;border:none}

/* focus badge */
.badge-focus{padding:6px 8px;border-radius:999px;background:#e6ffef;color:#024731;font-weight:700}

/* status */
.status{margin-top:10px}
.muted{color:var(--muted);font-size:14px}

/* responsive tweaks */
@media (max-width:460px){
  .name{min-width:70px}
  .small-bar{width:86px}
  .header h1{font-size:20px}
  .input{padding:10px}
}
</style>
</head>
<body>
<main class="wrap" role="main">
  <header class="header">
    <h1>ðŸ”¥ Rizz System â€” Version 1 <span class="muted">(Phase A)</span></h1>
    <p class="sub">Focus limit = <strong>2</strong> Â· Auto-focus â‰¥90% Â· Decay âˆ’10 every 2 days</p>
  </header>

  <section class="controls-row">
    <input id="nameInput" class="input" placeholder="Add name (e.g. Charity)" aria-label="Add name">
    <div class="btn-group">
      <button id="addBtn" class="btn primary">Add / Update</button>
      <button id="decayBtn" class="btn">Run Decay</button>
    </div>
  </section>

  <section class="controls-row">
    <div class="btn-group">
      <button id="pauseAll" class="btn">Pause All</button>
      <button id="resumeAll" class="btn ghost">Resume All</button>
    </div>
  </section>

  <section class="card" aria-live="polite">
    <div class="card-top">
      <div class="phase-title">Phase â€” <span id="phase">0%</span></div>
      <div class="bar-wrap" aria-hidden>
        <div id="phaseBar" class="bar-inner" style="width:0%"></div>
      </div>
    </div>

    <div class="card-actions">
      <button id="decMinus10" class="pill">âˆ’10</button>
      <button id="incPlus10" class="pill">+10</button>
      <button id="focusBtn" class="pill">Focus / Unfocus</button>
      <button id="deleteBtn" class="pill danger">Delete Focused</button>
    </div>
  </section>

  <section id="list" class="list" aria-live="polite">
    <!-- list items render here -->
  </section>

  <footer class="status">
    <div id="statusText" class="muted">Ready</div>
  </footer>
</main>

<script>
/* Rizz System v1 â€” Single-file final
   - All Version 1 features preserved
   - Enter-to-add, empty-state, auto-focus >=90%
   - Focus limit = 2 with auto-unfocus oldest
   - Decay, Pause/Resume, per-person & global actions
   - No external files required
*/

const STORAGE_KEY = 'rizz_rizz_v1_final';
const FOCUS_LIMIT = 2;
const DECAY_AMOUNT = 10;

let people = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');

const $ = id => document.getElementById(id);
const uid = () => Date.now().toString(36) + '_' + Math.random().toString(36).slice(2,6);

function save() {
  try { localStorage.setItem(STORAGE_KEY, JSON.stringify(people)); } catch(e){ console.error(e); }
}

function setStatus(txt) {
  const s = $('statusText'); if(s) s.textContent = txt || 'Ready';
}

/* Enable/disable global controls when appropriate */
function updateControlsState() {
  const empty = people.length === 0;
  $('decMinus10').disabled = empty;
  $('incPlus10').disabled = empty;
  $('focusBtn').disabled = empty;
  $('deleteBtn').disabled = empty;
}

/* Render */
function render() {
  const list = $('list');
  list.innerHTML = '';

  if (people.length === 0) {
    const msg = document.createElement('div');
    msg.className = 'muted';
    msg.textContent = 'No entries yet â€” add a name above';
    list.appendChild(msg);
    $('phase').textContent = '0%';
    $('phaseBar').style.width = '0%';
    updateControlsState();
    save();
    return;
  }

  // compute average
  const avg = Math.round(people.reduce((s,p)=>s+p.score,0) / people.length);
  $('phase').textContent = avg + '%';
  $('phaseBar').style.width = avg + '%';

  // sort: focused first, then active, then score desc
  const sorted = people.slice().sort((a,b)=>{
    if(a.focused && !b.focused) return -1;
    if(b.focused && !a.focused) return 1;
    if(a.active !== b.active) return a.active ? -1 : 1;
    return b.score - a.score;
  });

  const frag = document.createDocumentFragment();

  sorted.forEach(p => {
    const row = document.createElement('div');
    row.className = 'person' + (p.active ? '' : ' paused');

    // left block
    const left = document.createElement('div');
    left.style.display = 'flex';
    left.style.gap = '12px';
    left.style.alignItems = 'center';

    const name = document.createElement('div'); name.className = 'name'; name.textContent = p.name;
    const score = document.createElement('div'); score.className = 'score'; score.textContent = p.score + '%';

    const smallBar = document.createElement('div'); smallBar.className = 'small-bar';
    const smallInner = document.createElement('div'); smallInner.className = 'small-inner';
    smallInner.style.width = p.score + '%';
    smallBar.appendChild(smallInner);

    left.appendChild(name);
    left.appendChild(score);
    left.appendChild(smallBar);

    if (p.focused) {
      const badge = document.createElement('div'); badge.className = 'badge-focus'; badge.textContent = 'FOCUS';
      left.appendChild(badge);
    }

    // right actions
    const right = document.createElement('div'); right.className = 'right';
    const bPlus = makeButton('+10', () => adjustScore(p.id, +10));
    const bMinus = makeButton('âˆ’10', () => adjustScore(p.id, -10));
    const bFocus = makeButton(p.focused ? 'Unfocus' : 'Focus', () => toggleFocus(p.id), 'small ghost');
    const bActive = makeButton(p.active ? 'Pause' : 'Activate', () => toggleActive(p.id), 'small ghost');
    const bDelete = makeButton('Delete', () => removeOne(p.id), 'small danger');

    right.appendChild(bPlus);
    right.appendChild(bMinus);
    right.appendChild(bFocus);
    right.appendChild(bActive);
    right.appendChild(bDelete);

    row.appendChild(left);
    row.appendChild(right);
    frag.appendChild(row);
  });

  list.appendChild(frag);
  updateControlsState();
  save();
  setStatus('Rendered ' + people.length + ' entries');
}

function makeButton(label, cb, cls) {
  const b = document.createElement('button');
  b.textContent = label;
  b.className = cls || 'small';
  b.onclick = cb;
  return b;
}

/* Core functions */
function addOrUpdate() {
  const input = $('nameInput');
  const name = input.value.trim();
  if (!name) { setStatus('Type a name'); return; }

  const existing = people.find(p => p.name.toLowerCase() === name.toLowerCase());
  if (existing) {
    existing.score = Math.min(100, existing.score + 10);
    if (existing.score >= 90) autoFocus(existing);
    setStatus('Updated ' + existing.name);
  } else {
    const person = { id: uid(), name, score: 30, focused: false, active: true, createdAt: Date.now(), lastFocusedAt: 0 };
    people.push(person);
    setStatus('Added ' + name);
  }
  input.value = '';
  render();
}

function adjustScore(id, delta) {
  const p = people.find(x => x.id === id);
  if (!p) return;
  if (!p.active) { setStatus('Person is paused'); return; }
  p.score = Math.max(0, Math.min(100, p.score + delta));
  if (p.score >= 90) autoFocus(p);
  render();
}

/* Auto-focus (score >= 90) */
function autoFocus(person) {
  if (person.focused) return;
  const focused = people.filter(x => x.focused);
  if (focused.length >= FOCUS_LIMIT) {
    focused.sort((a,b)=> (a.lastFocusedAt||a.createdAt) - (b.lastFocusedAt||b.createdAt));
    focused[0].focused = false;
  }
  person.focused = true;
  person.lastFocusedAt = Date.now();
  setStatus('Auto-focused ' + person.name + ' (â‰¥90%)');
}

/* Focus toggle with limit enforcement */
function toggleFocus(id) {
  const p = people.find(x => x.id === id);
  if (!p || !p.active) { setStatus('Cannot focus a paused person'); return; }

  if (!p.focused) {
    const focused = people.filter(x => x.focused);
    if (focused.length >= FOCUS_LIMIT) {
      focused.sort((a,b)=> (a.lastFocusedAt||a.createdAt) - (b.lastFocusedAt||b.createdAt));
      focused[0].focused = false;
    }
    p.focused = true;
    p.lastFocusedAt = Date.now();
    setStatus('Focused ' + p.name);
  } else {
    p.focused = false;
    setStatus('Unfocused ' + p.name);
  }
  render();
}

function toggleActive(id) {
  const p = people.find(x => x.id === id);
  if (!p) return;
  p.active = !p.active;
  if (!p.active) p.focused = false;
  setStatus((p.active ? 'Activated ' : 'Paused ') + p.name);
  render();
}

function removeOne(id) {
  people = people.filter(p => p.id !== id);
  setStatus('Deleted entry');
  render();
}

/* Global actions */
function pauseAll(){
  people.forEach(p=>{p.active=false;p.focused=false});
  setStatus('All paused');
  render();
}
function resumeAll(){
  people.forEach(p=>p.active=true);
  setStatus('All resumed');
  render();
}
function runDecay(){
  let changed = false;
  people.forEach(p=>{
    if(p.active){
      const old = p.score;
      p.score = Math.max(0, p.score - DECAY_AMOUNT);
      if(p.score !== old) changed = true;
      if(p.score >= 90) autoFocus(p);
    }
  });
  setStatus(changed ? 'Decay applied' : 'Decay run â€” no changes');
  if(changed) render();
}

/* Card-level bulk actions */
function globalMinus10(){
  let applied=false;
  people.forEach(p=>{ if(p.focused && p.active){ p.score = Math.max(0,p.score-10); applied=true; }});
  setStatus(applied ? 'âˆ’10 applied to focused' : 'No focused/active items');
  if(applied) render();
}
function globalPlus10(){
  let applied=false;
  people.forEach(p=>{ if(p.focused && p.active){ p.score = Math.min(100,p.score+10); applied=true; if(p.score>=90) autoFocus(p); }});
  setStatus(applied ? '+10 applied to focused' : 'No focused/active items');
  if(applied) render();
}
function globalFocusToggle(){
  const anyFocused = people.some(p=>p.focused);
  if(!anyFocused){
    // focus top active by score
    const top = people.filter(p=>p.active).sort((a,b)=>b.score-a.score)[0];
    if(top) toggleFocus(top.id);
    else setStatus('No active items to focus');
  } else {
    people.forEach(p=>p.focused=false);
    setStatus('All unfocused');
    render();
  }
}
function deleteFocused(){
  const count = people.filter(p=>p.focused).length;
  if(!count){ setStatus('No focused items'); return; }
  people = people.filter(p=>!p.focused);
  setStatus('Deleted focused items');
  render();
}

/* Wiring UI */
window.addEventListener('DOMContentLoaded', ()=>{
  $('addBtn').onclick = addOrUpdate;
  $('decayBtn').onclick = runDecay;
  $('pauseAll').onclick = pauseAll;
  $('resumeAll').onclick = resumeAll;

  $('decMinus10').onclick = globalMinus10;
  $('incPlus10').onclick = globalPlus10;
  $('focusBtn').onclick = globalFocusToggle;
  $('deleteBtn').onclick = deleteFocused;

  $('nameInput').addEventListener('keydown', e => { if(e.key === 'Enter') addOrUpdate(); });

  // initial render
  render();
});

/* Expose for debugging if needed */
window.RizzV1 = {
  state: ()=> people.slice(),
  render,
  runDecay
};
</script>
</body>
</html>